# 数据库操作接口定义

- type: Database
  id: DB-FindUserByPhone
  description: 根据手机号查询用户信息
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回匹配的手机号用户信息
    - 如果手机号不存在，返回null
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-FindUserByEmail
  description: 根据邮箱查询用户信息
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回匹配的邮箱用户信息
    - 如果邮箱不存在，返回null
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-FindUserByUsername
  description: 根据用户名查询用户信息
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回匹配的用户名信息
    - 如果用户名不存在，返回null
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-CreateUser
  description: 在数据库中创建一个新的用户记录
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，users表中会增加一条新记录
    - 如果手机号已存在，操作应失败并抛出唯一性约束错误
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-VerifyPassword
  description: 验证用户密码是否正确
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回密码验证结果（true/false）
    - 验证过程应使用安全的密码哈希算法
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-CreateVerificationCode
  description: 创建并存储手机验证码
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，在验证码表中创建一条新记录
    - 验证码应为6位数字，有效期为5分钟
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-VerifyCode
  description: 验证手机验证码是否正确
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回验证码验证结果（true/false）
    - 验证后应标记验证码为已使用
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-UpdateUserPassword
  description: 更新用户密码
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，更新users表中对应用户的密码字段
    - 密码应使用安全的哈希算法存储
  changeLog:
    - date: "2025-11-11"
      description: "初始创建"

- type: Database
  id: DB-FindOrdersByUserId
  description: 根据用户ID和筛选条件查询订单列表。
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回指定用户的订单记录列表。
    - 如果用户不存在或没有订单，返回空列表。
  changeLog:
    - date: "2025-11-15"
      description: "初始创建，用于订单管理列表。"

- type: Database
  id: DB-FindOrderById
  description: 根据订单ID查询单个订单的完整信息。
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，返回唯一的订单记录。
    - 如果订单ID不存在，返回null。
  changeLog:
    - date: "2025-11-15"
      description: "初始创建，用于订单详情页。"

- type: Database
  id: DB-UpdateOrderStatus
  description: 更新指定订单的状态。
  dependencies:
    - none
  acceptanceCriteria:
    - 成功执行后，目标订单的状态被更新。
    - 如果订单ID不存在，操作失败。
  changeLog:
    - date: "2025-11-15"
      description: "初始创建，用于取消订单等操作。"
